<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accessing SLGA Data • slga</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Accessing SLGA Data">
<meta property="og:description" content="slga">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-108472319-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-108472319-3');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slga</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/slga.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/obrl-soil/slga">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="slga_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Accessing SLGA Data</h1>
                        <h4 class="author"><span class="citation">@obrl_soil</span></h4>
            
            <h4 class="date">2021-01-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/obrl-soil/slga/blob/master/vignettes/slga.Rmd"><code>vignettes/slga.Rmd</code></a></small>
      <div class="hidden name"><code>slga.Rmd</code></div>

    </div>

    
    
<p>This is a quick overview of how to retrieve data from the Soil and Landscape Grid of Australia.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/obrl-soil/slga">slga</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Two high-level wrapper functions, <code><a href="../reference/get_soils_data.html">get_soils_data()</a></code> and <code><a href="../reference/get_lscape_data.html">get_lscape_data()</a></code>, have been provided to manage downloads. To use them correctly, you should be aware of the package datasets <code><a href="../reference/slga_attribute_info.html">slga_attribute_info()</a></code> and <code><a href="../reference/slga_product_info.html">slga_product_info()</a></code>. They contain allowable values for some of the function inputs as well as key metadata.</p>
<p>The two tables are derived from information on the <a href="https://www.clw.csiro.au/aclep/soilandlandscapegrid">SLGA website</a> and in the WCS metadata documents.</p>
<div id="soils-data" class="section level2">
<h2 class="hasAnchor">
<a href="#soils-data" class="anchor"></a>Soils data</h2>
<p>Soils data is available in a large number of combinations - each product has a set of available attributes (soil properties). Not all soil attributes are available within each product, but you can check which ones are available in <code><a href="../reference/slga_attribute_info.html">slga_attribute_info()</a></code>. Each soil attribute has six depth slices extending from the land surface to 2.0 metres below. Each soil attribute also has three associated values - the estimated value, plus its lower (5%) and upper (95%) confidence limits. Effectively, if you visited a single pixel on the Grid and sampled 100 points inside that pixel, you should expect that 90 of those samples would return values within those limits.</p>
<p>Detailed metadata for each product can be found on the <a href="https://data.csiro.au/dap">CSIRO Data Access Portal</a></p>
<p>The function <code><a href="../reference/get_soils_data.html">get_soils_data()</a></code> is capable of pulling out data for one combination of product, soil attribute, and depth. It gives the option of returning any combination of value and confidence interval layers, either as a <code>raster</code> or <code>rasterStack</code> object.</p>
<p>As a demonstration, the surface (0.0-0.05 metre) estimated percent clay content for central Brisbane is available with <code><a href="https://rdrr.io/r/utils/data.html">data('bne_surface_clay')</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">'bne_surface_clay'</span><span class="op">)</span>
<span class="va">bne_surface_clay</span>
<span class="co">#&gt; class      : RasterStack </span>
<span class="co">#&gt; dimensions : 121, 145, 17545, 3  (nrow, ncol, ncell, nlayers)</span>
<span class="co">#&gt; resolution : 0.0008333333, 0.0008333333  (x, y)</span>
<span class="co">#&gt; extent     : 152.9496, 153.0704, -27.55042, -27.44958  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +init=EPSG:4283 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs </span>
<span class="co">#&gt; names      : NAT_CLY_VAL_000_005, NAT_CLY_CLO_000_005, NAT_CLY_CHI_000_005 </span>
<span class="co">#&gt; min values :           10.100820,           -3.681541,           23.713245 </span>
<span class="co">#&gt; max values :            33.95562,            19.32191,            48.78592</span></code></pre></div>
<p><img src="clayplot.png" style="width:95.0%"></p>
<p>Note that some open-water areas have 0 values rather than NA; these are difficult to remove safely without an adequate mask. You may need to generate one yourself, particularly if you are working along the coast.</p>
<p>The query to retrieve the above maps looked like:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">152.95</span>, <span class="op">-</span><span class="fl">27.55</span>, <span class="fl">153.07</span>, <span class="op">-</span><span class="fl">27.45</span><span class="op">)</span>
<span class="va">bne_surface_clay</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_soils_data.html">get_soils_data</a></span><span class="op">(</span>product <span class="op">=</span> <span class="st">'NAT'</span>, attribute <span class="op">=</span> <span class="st">'CLY'</span>,
                                   component <span class="op">=</span> <span class="st">'ALL'</span>, depth <span class="op">=</span> <span class="fl">1</span>,
                                   aoi <span class="op">=</span> <span class="va">aoi</span>, write_out <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Note that valid <code>product</code> parameters are defined in <code>slga_product_info$Short_Name</code>, and valid <code>attribute</code> parameters in <code>slga_attribute_info$Code</code>. If a particular combination is not available, the function will fail gracefully.</p>
</div>
<div id="landscape-data" class="section level2">
<h2 class="hasAnchor">
<a href="#landscape-data" class="anchor"></a>Landscape data</h2>
<p>18 landscape datasets are available, describing DEM-derived terrain attributes and climatic influences. These are considered to be effective environmental covariates in soil modelling exercises. Detailed metadata for each product can be found on the <a href="https://data.csiro.au/dap">CSIRO Data Access Portal</a>.</p>
<p><code><a href="../reference/get_lscape_data.html">get_lscape_data()</a></code> only requires a product code and aoi, as each landscape attribute is a single raster surface. For example, the Multi-resolution Valley Bottom Flatness Index for central Brisbane is given by</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bne_mrvbf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lscape_data.html">get_lscape_data</a></span><span class="op">(</span>product <span class="op">=</span> <span class="st">'MRVBF'</span>, aoi <span class="op">=</span> <span class="va">aoi</span>, write_out <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="area-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#area-of-interest" class="anchor"></a>Area of interest</h2>
<p><code>slga</code> output datasets are always source-aligned - that is, the returned SLGA data will align with its parent coverage rather than your supplied <code>aoi</code> parameter. This is deliberate; WCS services default to target-alignment, which involves hidden server-side resampling behaviour when a geographical subset is supplied. This behaviour is essential for WCS’ primary use case - accessing data dynamically in a GUI. For constructing reproducible workflows that start with rasters, however, it is not appropriate. If you need a dataset that aligns with other data, it is best practice to carry out any resampling and realignment at your end, after retrieving a ‘clean’ subset of SLGA data. This ensures that these operations are clearly documented. Functions like <code><a href="https://rdrr.io/pkg/raster/man/resample.html">raster::resample()</a></code> may be useful at this point.</p>
</div>
<div id="saving-data" class="section level2">
<h2 class="hasAnchor">
<a href="#saving-data" class="anchor"></a>Saving data</h2>
<p>If you want to save a copy of the downloaded raster(s) to disk, you will need to specify <code>write_out = TRUE</code> and supply a directory using the <code>filedir</code> parameter. A full path to an existing directory must be supplied, so any of the following styles will work:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filedir</span> <span class="op">=</span> <span class="st">'C:/data'</span>
<span class="va">filedir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">filedir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">'C:'</span>, <span class="st">'data'</span><span class="op">)</span></code></pre></div>
<p>Files are saved in GeoTIFF format with an appropriate datatype and an informative filename. Note that existing files will be overwritten if a file with a matching name is detected in the destination directory.</p>
</div>
<div id="advanced-querying" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-querying" class="anchor"></a>Advanced querying</h2>
<p>To retrieve data from e.g. more than one depth, you can use an iterator like <code><a href="https://rdrr.io/r/base/lapply.html">base::lapply()</a></code> or <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map()</a></code>. For instance, to retrieve estimated clay values for all depths over King Island, you could do the following:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># not run</span>
<span class="va">bne_all_clay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq.int</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/get_soils_data.html">get_soils_data</a></span><span class="op">(</span>product <span class="op">=</span> <span class="st">'NAT'</span>, attribute <span class="op">=</span> <span class="st">'CLY'</span>, component <span class="op">=</span> <span class="st">'VAL'</span>,
                 depth <span class="op">=</span> <span class="va">d</span>, aoi <span class="op">=</span> <span class="va">aoi</span>, write_out <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">bne_all_clay</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html">brick</a></span><span class="op">(</span><span class="va">bne_all_clay</span><span class="op">)</span></code></pre></div>
<p>Similar iteration can be carried out with a vector of attributes or products. Note that while all the soils products align with each other, not all of the landscape products do. Stacking the latter together will require some pre-processing.</p>
</div>
<div id="point-data" class="section level2">
<h2 class="hasAnchor">
<a href="#point-data" class="anchor"></a>Point data</h2>
<p>Data values for single-point locations within the grid can be retrieved using <code><a href="../reference/get_soils_point.html">get_soils_point()</a></code> or <code><a href="../reference/get_lscape_point.html">get_lscape_point()</a></code>, as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#not run</span>
<span class="va">clay_pt</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_soils_point.html">get_soils_point</a></span><span class="op">(</span><span class="st">'NAT'</span>, <span class="st">'CLY'</span>, <span class="st">'VAL'</span>, <span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">153</span>, <span class="op">-</span><span class="fl">27.5</span><span class="op">)</span><span class="op">)</span>
<span class="va">slope_pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lscape_point.html">get_lscape_point</a></span><span class="op">(</span><span class="st">'SLPPC'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">153</span>, <span class="op">-</span><span class="fl">27.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>A non-spatial dataframe of values is returned. Summaries of the area around a point can also be retrieved. The summary can be of a square or circular window around a point.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get the average predicted clay content for 60-100cm within ~300m of a point</span>
<span class="va">avg_clay</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_soils_point.html">get_soils_point</a></span><span class="op">(</span><span class="st">'NAT'</span>, <span class="st">'CLY'</span>, <span class="st">'VAL'</span>, <span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">153</span>, <span class="op">-</span><span class="fl">27.5</span><span class="op">)</span>,
                            buff <span class="op">=</span> <span class="fl">3</span>, buff_shp <span class="op">=</span> <span class="st">'circle'</span>, stat <span class="op">=</span> <span class="st">'mean'</span><span class="op">)</span></code></pre></div>
<p>Buffering is defined in terms of cells, not metres. A buffer of <code>n</code> cells implies that the raster extracted will be <code>2n + 1</code> cells wide and high, centered on the cell into which the supplied point of interest falls.</p>
<p>Note that for datasets that have many points within a small area, it will be more efficient to download rasters covering the dataset bounding box before extracting point summaries using existing <code>raster</code> package functions.</p>
</div>
<div id="metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#metadata" class="anchor"></a>Metadata</h2>
<p>Service and coverage level metadata for soil and landscape data can be retrieved with <code><a href="../reference/metadata_soils.html">metadata_soils()</a></code> and <code><a href="../reference/metadata_lscape.html">metadata_lscape()</a></code>. For example,</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nat_clay_mdc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metadata_soils.html">metadata_soils</a></span><span class="op">(</span><span class="st">'NAT'</span>, <span class="st">'CLY'</span>, req_type <span class="op">=</span> <span class="st">'desc'</span><span class="op">)</span></code></pre></div>
<hr>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lauren O'Brien.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
